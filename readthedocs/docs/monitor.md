# Monitor

## Simulation time
cloudHPC provides an estimate - ETA - of the total simulation's duration. This is provided after the simulation has been executed and it is available in your Output as highlited by the image below. The ETA estimate is available only for the following software:

* FDS [all versions]

<p align="center">
   <img width=650 src="https://cfdfeaservice.it/wiki/cloud-hpc/images/ETA.png">
</p>

!!! note
    The provided duration should be considered a preliminary estimate and does not constitute a contractual element or a binding quote. Consequently, the final cost will be determined based on the actual consumption measured at the end of the activity.

### Manual estimate
To manually evaluate the simulationâ€™s duration, you can check how many iterations are pursued and in how much time. This estimation can be done after at least 2 hours of simulation.
You can then evaluate how many seconds of simulation are pursued in real-time. Hence, for instance, how many seconds of simulation are calculated in 2 hours. If you want to pursue a simulation of 600 seconds and you valuate that a simulation time of 120 seconds is calculated in 2 hours analysis. Then you would know that your simulation would take approximately 60 seconds of simulation time each hour. Consequently, it would take 10 hours to complete a simulation time of 600 seconds. 

<p align="center">
120s : 2h = 60s/h

600s : 6s/h = 10 h
</p>

## Runtime monitor
The cloud HPC system, offers you the possibility to monitor your analysis in runtime during the simulation and, at the same time, to check the usage of the hardware resources in terms of vCPU and RAM, during the analysis. In order to access the monitor you need to enter the simulation details by clicking the "View" button of the analysis you want to monitor.

<p align="center">
   <img width="600" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/FIG_13_VIEW_SIM.png">
</p>

Considering the software you are using, it's possible to monitor several results during the simulation:

* **OPENFOAM**: the cloud HPC authomatically generates a chart for each runtime post-processing activated in _controlDict_. It is important that you set it before launching the analysis with the post-processing you want to detect: residuals, max pressure/velocity, temperatures, flow calculations, etc. In order to have a template of the controlDict file you can check [here](https://github.com/CFD-FEA-SERVICE/CloudHPC/blob/master/template/OpenFOAM/system/controlDict).

* **FDS**: they system authomatically convertes into chart every CSV file generated by FDS during the runtime. In order to see the results you need to set up &DEV (devices) and properly assign them variables to monitor.

<p align="center">
   <img width="300" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/FIG_15_data_monitoring.png">
</p>

## Runtime logs
Every simulation software produces a log file which is displayed directly at runtime in the proper section of the web app. It is possible for you to check these logs in two ways:

1. Through the **Output** section where you can see a brief summary of the simulation status
1. In the Logs section where every log file produced is reported and made accessible. The access remains also when the simulation is terminated as a reference 

<p align="center">
   <img width="600" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/LogFiles.jpg">
</p>

## Remote desktop
For enabled accounts, it is possible to access the virtal machine where the simulation is actually performed via remote desktop. This feature is available under the "view" page of each simulation and gives you access to all hardware resources of the instance where simulation is performed. With that you can:

* monitor your running process
* check status of the hardware resources
* run your preferred post-processing software such as ParaView, SALOME or Smokeview

The remote desktop is made available for all simulations where status is RUNNING. To access it just enter the "view" page of the simulation and scroll down at the bottom of the page.

<p align="center">
   <img width="600" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/RemoteDesktop.jpg">
</p>

<p align="center">
   <a href="https://www.youtube.com/watch?v=yPJWTfmcsY4"><img width="460" height="300" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/YoutubeVideo.png"></a>
</p>

## Hardware monitor
Beyond results extracted by the solver, at any time it is possible to monitor the usage of vCPU and RAM are. These graphs are important in order to understand if the computational capacity chosen for your simulation is enough or overestimated.

As a general rule, you can try to always have at least 1000 Mb available in the _Free line_ (red).

<p align="center">
   <img width="300" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/FIG_16_CPU_good.png">
   <img width="300" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/FIG_17_RAM_good.png">
</p>

## SSH Connection
Advanced users can also connect via SSH to the instances where the simulation is running. This allows you to enter the instance and get full control of the running analysis. You are also given the possibility, for example, to create/edit/cancel files.

!!! note
    CFD FEA SERVICE SRL can't take resposibility for the user actions taken when he enters the instance. In particular if you stop the simulation or delete all the results produced by the simulation, it's impossible to us to retrieve these information.

### Prerequisites

!!! info
    For security reasons, SSH port 22 is closed to all accounts. In order to open that port for your specific IP address, contact our suppor team.

In order to get SSH access to the running simulations make sure you have correctly saved your public key into your profile such as described in the following image:

<p align="center">
   <img width="600" src="https://cfdfeaservice.it/wiki/cloud-hpc/images/SSHkey.jpg">
</p>

In order to retrieve your public key on Linux based systems, you can just run the following command on a terminal:

	cat .ssh/id_rsa.pub

### Connect via SSH
Once you have saved your public key to access via SSH to a running instance type the following command:

	ssh -X -o "StrictHostKeyChecking no" cloudhpc@SIMULATION_IP_ADDRESS

where SIMULATION\_IP\_ADDRESS is reported in the "view" page of the running analysis. The same result can also be achieved using the script [cloudHPCexec](https://github.com/CFD-FEA-SERVICE/CloudHPC/wiki#for-advanced-users) by typing:

	cloudHPCexec -ssh SIMULATION_ID
